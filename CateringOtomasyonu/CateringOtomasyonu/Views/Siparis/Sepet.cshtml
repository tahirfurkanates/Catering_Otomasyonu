@model List<CateringOtomasyonu.Models.CartItem>
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@{
    ViewData["Title"] = "Sepetim";
    decimal toplam = (decimal)(ViewBag.Toplam ?? 0m);
}

<div class="container py-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h4 m-0">Sepetim</h1>
        <a class="btn btn-outline-danger btn-sm" asp-action="Temizle">Sepeti Temizle</a>
    </div>

    @if (Model == null || !Model.Any())
    {
        <div class="alert alert-info">Sepetiniz boş.</div>
    }
    else
    {
        <div class="table-responsive">
            <table class="table align-middle">
                <thead>
                    <tr>
                        <th>Ürün</th>
                        <th style="width:120px;">Adet</th>
                        <th class="text-end" style="width:140px;">Birim Fiyat</th>
                        <th class="text-end" style="width:140px;">Tutar</th>
                        <th style="width:60px;"></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var x in Model)
                    {
                        <tr>
                            <td>@x.Ad</td>
                            <td>
                                <form asp-action="AdetGuncelle" method="get" class="d-flex">
                                    <input type="hidden" name="id" value="@x.MenuOgeleriId" />
                                    <input type="number" name="adet" value="@x.Adet" min="1" class="form-control form-control-sm me-2" />
                                    <button class="btn btn-sm btn-outline-secondary">Güncelle</button>
                                </form>
                            </td>
                            <td class="text-end">@x.BirimFiyat.ToString("c")</td>
                            <td class="text-end">@x.Tutar.ToString("c")</td>
                            <td>
                                <a class="btn btn-sm btn-outline-danger" asp-action="Sil" asp-route-id="@x.MenuOgeleriId">Sil</a>
                            </td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="3" class="text-end">Toplam:</th>
                        <th class="text-end">@toplam.ToString("c")</th>
                        <th></th>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div class="text-end mt-3">
            <!-- ARTIK HERKES İÇİN AKTİF -->
            <a class="btn btn-success me-2"
               asp-controller="Davet" asp-action="Olustur">
                Davet Oluştur
            </a>

            <a class="btn btn-primary">Siparişi Tamamla</a>
        </div>
    }
</div>
